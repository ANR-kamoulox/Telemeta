{% extends "telemeta/mediaitem_detail.html" %}
{% load i18n %}
{% load telemeta_utils %}
{% load bootstrap3 %}

{% block title %}
<img src="{{ STATIC_URL }}telemeta/images/item.png" style="vertical-align:middle" /> Item : {{ item }}
{% endblock %}

{% block title_buttons %}
<div class="fixedWidthAsPlayer">
    <a href="{% url "telemeta-item-detail" item.public_id %}" class="component_icon button icon_cancel">{% trans "Cancel" %}</a>
</div>
{% endblock %}

{% block infos %}
  <div>
    <form enctype="multipart/form-data" id="_editItemForm" method="post" action="">{% csrf_token %}

    <ul class="nav nav-tabs" role="tablist">
      <li class="active"><a href="#general" role="tab" data-toggle="tab">{% trans "General" %}</a></li>
      <li><a href="#related" role="tab" data-toggle="tab">{% trans "Related media" %}</a></li>
      <li><a href="#keyword_relations" role="tab" data-toggle="tab">{% trans "Keywords" %}</a></li>
      <li><a href="#performances" role="tab" data-toggle="tab">{% trans "Performance" %}</a></li>
      <li><a href="#format" role="tab" data-toggle="tab">{% trans "Format" %}</a></li>
      <li><a href="#identifiers" role="tab" data-toggle="tab">{% trans "Identifier" %}</a></li>
    </ul>

    <div class="tab-content">

      <div class="tab-pane fade in active" id="general">
        <script type="text/javascript" src="/static/admin/js/jquery.min.js"></script>
        <script type="text/javascript" src="/static/admin/js/jquery.init.js"></script>
        <script type="text/javascript" src="/static/admin/js/actions.min.js"></script>
        {{ form.media }}
        <div class="block-grey">
        {% bootstrap_form form %}
        {% trans "Collection access status" %} : {% trans item.collection.public_access %}<br />
        {% trans "Context access status" %} : {% trans access %}<br />
        </div>
      </div>

      {% for formset in inlines %}
      <div class="tab-pane" id="{{ formset.prefix }}">
          {{ formset.management_form }}
          {% for form in formset %}
           <div class="block-grey">
           {% bootstrap_form form %}
           </div>
          {% endfor %}
      </div>
      {% endfor %}

    </div>

    <div align="center" style="margin-top:3ex;">
     {% block cancel %}
     <a href="{% url "telemeta-item-detail" item.public_id %}" class="component_icon button icon_cancel">{% trans "Cancel" %}</a>
     {% endblock %}

     {% if perms.telemeta.change_mediaitem %}
      <input type="submit" value="{% trans "Save" %}" class="default" name="_save" onclick="var d=document; d.getElementById('wait-img').style.display='inline'; setTimeout(function(){d.getElementById('_editItemForm').submit();},300); return false;"/>
      <img id="wait-img" style="display:none" style="vertical-align:middle" alt="wait" src="{{ STATIC_URL }}telemeta/images/wait.gif" />
     {% endif %}
    </div>

   </form>
  </div>

{% endblock infos %}

{% block related %}
{% endblock %}

{% block delete %}
{% endblock %}
